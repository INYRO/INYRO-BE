version: "3.8"

services:
  redis:
    image: redis:7.2
    container_name: redis_container
    ports:
      - "6379:6379"               # ✅ 외부에서도 필요시 접근 가능
    networks:
      - inyro-network
    restart: unless-stopped

  app:
    image: inyro/web:latest
    container_name: inyro_reservation
    ports:
      - "8080:8080"               # ✅ 외부 접속용
    env_file:
      - /home/ubuntu/secrets/.env
    depends_on:
      - redis                     # ✅ Redis 먼저 시작
    networks:
      - inyro-network
    restart: unless-stopped

networks:
  inyro-network:
    driver: bridge
